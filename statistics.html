<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <link rel="manifest" href="./manifest.json">
  <script src="./js/main.js"></script>
<meta name="theme-color" content="#007aff">
<script>
document.addEventListener("DOMContentLoaded", () => {
  const role = localStorage.getItem("userRole");

  if (role !== "owner") {
    document.body.innerHTML = `
      <div style="display:flex;flex-direction:column;justify-content:center;align-items:center;height:100vh;font-family:sans-serif;text-align:center;gap:20px;">
        <h2>Sorry, you are not the owner and cannot view this page.</h2>
        <a href="./orders.html" 
           style="padding:10px 20px;background:#007bff;color:white;text-decoration:none;border-radius:5px;font-size:16px;">
           ðŸ›’ Go to Orders
        </a>
      </div>
    `;
  }
});
</script>

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ðŸ“Š Store Dashboard</title>
  
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link rel="stylesheet" href="./css/statistics.css">
</head>
<body>
  <main>
      <nav class="main-nav">
    <div class="nav-links">
      <a href="./orders.html" class="nav-link">ðŸ›’<span class="nav-text"> Orders</span></a>
      <a href="./products.html" class="nav-link">ðŸ“¦<span class="nav-text"> Products</span></a>
      <a href="./borrowers.html" class="nav-link">ðŸ‘¥<span class="nav-text"> Borrowers</span></a>
      <a href="./statistics.html" class="nav-link active">ðŸ“Š<span class="nav-text"> Statistics</span></a>
      <a href="./import_export.html" class="nav-link">ðŸ”„<span class="nav-text"> Import/Export</span></a>
    </div>
  </nav>

    <h1>ðŸ“ˆ Store Dashboard</h1>

    <div class="dashboard-grid" id="kpi-cards"></div>

    <div class="dashboard-grid" style="margin-top: 2rem;">
      <div class="stat-card chart-card">
        <div class="chart-header">
          <h3>Sales & Profit Over Time</h3>

          <div class="controls">
            <div class="duration-controls" id="salesChartDuration">
              <button data-duration="7" class="active">Last 7 Days</button>
              <button data-duration="30">Last 30 Days</button>
              <button data-duration="90">Last 90 Days</button>
              <button data-duration="365">Last 365 Days</button>
              <button data-duration="all">All Time</button>
            </div>

            <div class="custom-range" title="Custom range">
              <input type="date" id="customStart" />
              <span>to</span>
              <input type="date" id="customEnd" />
              <button id="applyCustom">Apply</button>
            </div>

            <select id="accuracySelect" class="accuracy-select" title="Label accuracy">
              <option value="auto">Auto</option>
              <option value="daily">Daily</option>
              <option value="3-day">3-Day</option>
              <option value="weekly">Weekly</option>
              <option value="monthly">Monthly</option>
            </select>
          </div>
        </div>

        <div class="chart-wrapper">
          <canvas id="salesProfitChart"></canvas>
        </div>
      </div>

      <div class="stat-card">
        <h3>Profit Margin</h3>
        <div class="donut-chart-wrapper">
          <canvas id="profitMarginChart"></canvas>
        </div>
      </div>

      <div class="stat-card">
        <h3>Top 5 Best-Selling Products</h3>
        <div class="chart-wrapper">
          <canvas id="topProductsChart"></canvas>
        </div>
      </div>
    </div>
  </main>
  

  <script src="https://sql.js.org/dist/sql-wasm.js"></script>
  <script type="module" src="../ui/statistics_ui.js"></script>
</body>
</html>
